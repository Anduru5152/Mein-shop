<script>
let loggedIn = false;
let cart = [];
let currentProduct = null;
let currentSlide = 0;
let inCartView = false;

const products=[];
for(let i=0;i<10;i++){
  products.push({
    id:i+1,
    name:"Produkt "+(i+1),
    price:9.99+i*10,
    images:[
      "https://via.placeholder.com/500x350?text=Produkt+"+(i+1)+"-1",
      "https://via.placeholder.com/500x350?text=Produkt+"+(i+1)+"-2"
    ]
  });
}

// --- Fake Login ---
function login(){
  const user = document.getElementById("loginName").value.trim();
  const pass = document.getElementById("loginPass").value.trim();

  if(user === "" || pass === ""){
    alert("Bitte Benutzername und Passwort eingeben!");
    return;
  }

  // Zum Test akzeptieren wir alles
  showShop();
}

function skipLogin(){
  showShop();
}

// --- Shop anzeigen ---
function showShop(){
  loggedIn = true;
  document.getElementById("authScreen").style.display="none";
  document.getElementById("mainHeader").style.display="flex";
  document.getElementById("productList").style.display="grid";
  document.getElementById("cartIcon").style.display="flex";
  inCartView = false;
  document.getElementById("headerSearch").placeholder="Produkte suchen...";
  renderProducts();
}

// --- Produkte rendern ---
function renderProducts(){
  const container=document.getElementById("productList");
  container.innerHTML="";
  products.forEach(p=>{
    const div=document.createElement("div");
    div.className="product";
    div.onclick=()=>openDetail(p.id);
    div.innerHTML=`
      <img src="${p.images[0]}" alt="${p.name}">
      <div class="product-info">
        <h3>${p.name}</h3>
        <p>${p.price.toFixed(2)} €</p>
        <button class="btn" onclick="event.stopPropagation(); addToCartFromList(${p.id})">In Warenkorb</button>
      </div>`;
    container.appendChild(div);
  });
}

// --- Produkt Detail öffnen ---
function openDetail(id){
  const product = products.find(p=>p.id===id);
  currentProduct = product;
  currentSlide = 0;
  document.getElementById("detailTitle").innerText = product.name;
  document.getElementById("detailImage").src = product.images[0];
  document.getElementById("detailPrice").innerText = product.price.toFixed(2)+" €";
  document.getElementById("productList").style.display="none";
  document.getElementById("detailView").style.display="block";
}

function closeDetail(){
  document.getElementById("detailView").style.display="none";
  document.getElementById("productList").style.display="grid";
}

function nextSlide(){
  if(!currentProduct) return;
  currentSlide = (currentSlide+1) % currentProduct.images.length;
  document.getElementById("detailImage").src = currentProduct.images[currentSlide];
}

function prevSlide(){
  if(!currentProduct) return;
  currentSlide = (currentSlide-1+currentProduct.images.length)%currentProduct.images.length;
  document.getElementById("detailImage").src = currentProduct.images[currentSlide];
}

// --- Warenkorb ---
function addToCartFromList(id){
  const product = products.find(p=>p.id===id);
  addToCart(product);
}

function addToCart(product){
  cart.push(product);
  updateCart();
  alert(product.name+" wurde in den Warenkorb gelegt!");
}

function updateCart(){
  document.getElementById("cartCount").innerText = cart.length;
}

function openCart(){
  inCartView = true;
  document.getElementById("productList").style.display="none";
  document.getElementById("detailView").style.display="none";
  document.getElementById("cartPage").style.display="block";
  document.getElementById("headerSearch").placeholder="Warenkorb durchsuchen...";

  let itemsHTML="";
  let total=0;
  cart.forEach((item,index)=>{
    itemsHTML+=`
      <div class="cart-item">
        <h3>${item.name}</h3>
        <p>${item.price.toFixed(2)} €</p>
        <button class="remove-btn" onclick="removeFromCart(${index})">aus Warenkorb entfernen</button>
      </div>`;
    total+=item.price;
  });
  document.getElementById("cartItems").innerHTML=itemsHTML || "<p>Warenkorb leer</p>";
  document.getElementById("cartTotal").innerText="Gesamt: "+total.toFixed(2)+" €";
}

function removeFromCart(index){
  cart.splice(index,1);
  openCart();
  updateCart();
}

function emptyCart(){
  cart = [];
  openCart();
  updateCart();
}

function backToShop(){
  document.getElementById("cartPage").style.display="none";
  document.getElementById("productList").style.display="grid";
  inCartView = false;
  document.getElementById("headerSearch").placeholder="Produkte suchen...";
}
</script>
